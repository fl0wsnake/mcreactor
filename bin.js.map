{"version":3,"sources":["webpack/bootstrap 69866f9ac1fb3fffb02b","D:\\1WebProjects\\mcreactor\\app.ts","external \"es6-shim\"","external \"reflect-metadata\"","external \"routing-controllers\"","D:\\1WebProjects\\mcreactor\\controllers\\UserController.ts","D:\\1WebProjects\\mcreactor\\models\\User.ts","D:\\1WebProjects\\mcreactor\\config\\db.ts","external \"sequelize\"","D:\\1WebProjects\\mcreactor\\middlewares\\AuthMiddleware.ts","D:\\1WebProjects\\mcreactor\\config\\jwt.ts","external \"jsonwebtoken\"","D:\\1WebProjects\\mcreactor\\middlewares\\AdminMiddleware.ts","D:\\1WebProjects\\mcreactor\\middlewares\\PugMiddleware.ts","external \"pug\"","external \"path\"","external \"lodash.defaults\"","D:\\1WebProjects\\mcreactor\\controllers\\AuthController.ts","D:\\1WebProjects\\mcreactor\\controllers\\FeedController.ts","external \"koa-convert\"","external \"koa-static-folder\"","external \"koa-bodyparser\"","external \"koa-cors\"","D:\\1WebProjects\\mcreactor\\middlewares\\CookieMiddleware.ts"],"names":[],"mappings":"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","file":"bin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 69866f9ac1fb3fffb02b","import 'es6-shim'\nimport \"reflect-metadata\";\nimport { createKoaServer } from \"routing-controllers\";\nimport \"./controllers/UserController.ts\"\nimport \"./controllers/AuthController.ts\"\nimport \"./controllers/FeedController.ts\"\nimport \"./middlewares/PugMiddleware.ts\"\nimport \"./middlewares/CookieMiddleware.ts\"\n\nconst path = require('path')\n\nconst convert = require('koa-convert')\n\nconst serve = require('koa-static-folder')\n\n\nconst app = createKoaServer()\n\n\napp.use(require('koa-bodyparser')())\n\napp.use(convert(serve('./public')))\n\nlet cors = require('koa-cors')\n\napp.use(convert(cors()))\n\n//cookie middleware\napp.use(async (context, next) => {\n\n})\n//\n\napp.listen(3000)\n\n\n\n// WEBPACK FOOTER //\n// ./app.ts","module.exports = require(\"es6-shim\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-shim\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"reflect-metadata\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"reflect-metadata\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"routing-controllers\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"routing-controllers\"\n// module id = 3\n// module chunks = 0","/**\n * Created by Monyk on 05.11.2016.\n */\n\nimport { Controller, Param, Body, Get, Post, Put, Delete, JsonController, Res, Middleware, UseBefore, Req } from 'routing-controllers';\nimport User from '../models/User';\nimport { ServerResponse } from \"http\";\nimport { UserAttribute } from '../models/User';\nimport * as _ from 'lodash'\nimport { AuthMiddleware } from '../middlewares/AuthMiddleware';\nimport { AdminMiddleware } from '../middlewares/AdminMiddleware'\nimport { Request } from '~koa/lib/request';\nimport { Response } from '~koa/lib/response';\nimport { PugMiddleware } from '../middlewares/PugMiddleware';\n\n@JsonController()\nexport class UserController {\n\n    @UseBefore(AuthMiddleware)\n    @Get(\"/users\")\n    async getAll() {\n        return await User.findAll({ raw: true, order: 'id' })\n    }\n\n    @Get(\"/users/:id\")\n    async getOne( @Param(\"id\") id: number) {\n        return await User.findById(id, { raw: true })//todo: validation\n    }\n\n    @UseBefore(AuthMiddleware, AdminMiddleware)\n    @Put(\"/users/:id\")\n    async put( @Param(\"id\") id: number, @Body() user: UserAttribute): Promise<any> {\n        const foundUser = await User.findById(id)//todo: restring access\n        if (foundUser) {\n            return (await foundUser.update(user)).get()\n        }\n        return { success: false, message: 'User not found' }\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/UserController.ts","/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\nexport interface UserAttribute\n{\n    id?:string\n    nickname?:string\n    email?:string\n    password?:string\n    rating?:number\n    isBanned?:boolean\n    isAdmin?:boolean\n    createdAt?:number\n    updatedAt?:number\n}\n\nexport interface UserInstance extends Sequelize.Instance<UserAttribute>, UserAttribute\n{}\n\nexport interface UserModel extends Sequelize.Model<UserInstance, UserAttribute>\n{}\n\nconst User : UserModel = db.define<UserInstance, UserAttribute>(\"User\", {\n    nickname: {\n        type: Sequelize.STRING,\n        allowNull: false,\n    },\n    email: {\n        type: Sequelize.STRING,\n        allowNull: false,\n        unique: true\n    },\n    password: {\n        type: Sequelize.STRING,\n        allowNull: false\n    },\n    rating: {\n        type: Sequelize.INTEGER,\n        allowNull: true\n    },\n    isBanned: {\n        type: Sequelize.BOOLEAN,\n        allowNull: true,\n        field: 'is_banned'\n    },\n    isAdmin: {\n        type: Sequelize.BOOLEAN,\n        allowNull: true,\n        field: 'is_admin'\n        \n    },\n}, {\n    tableName: 'users',\n    timestamps: true,\n    createdAt: \"created_at\",\n    updatedAt: \"updated_at\"\n})\n\nimport users from '../mocks/users'\n\nUser.sync().then(() => {\n    // users.forEach((user) => {\n        // User.create(<UserAttribute> user)\n    // })\n})\n\nexport default User\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/User.ts","/**\n * Created by Monyk on 05.11.2016.\n */\nimport * as Sequelize from 'sequelize'\n\nconst db : Sequelize.Sequelize = new Sequelize('postgres://monyk:root@localhost:5432/mcreactor')\n\nexport default db\n\n\n// WEBPACK FOOTER //\n// ./config/db.ts","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 7\n// module chunks = 0","import { Middleware, MiddlewareInterface} from 'routing-controllers';\nimport {Context} from 'koa'\nimport { UserAttribute } from '../models/User';\nimport { verifyToken } from '../config/jwt';\n\n\n\n@Middleware()\nexport class AuthMiddleware implements MiddlewareInterface {\n\n    use(context: Context, next: (err?: any) => Promise<any>): Promise<any> | null \n    {\n        const token = context.cookie.token\n        if(token)\n        {\n            const user : UserAttribute | boolean = verifyToken(token.toString())\n            if(user)\n            {\n                context.request.user = user\n                return next()\n            }\n        }\n        context.response.status = 403\n        context.response.body = '403 Forbidden'\n        return\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AuthMiddleware.ts","import { UserAttribute } from '../models/User';\r\nconst jwt = require('jsonwebtoken')\r\n\r\nconst secret = 'veryverysecret'\r\n\r\nexport function generateToken(user : UserAttribute) : string\r\n{\r\n    return jwt.sign(user, secret)\r\n}\r\n\r\nexport function verifyToken(token : string | undefined) : UserAttribute | false\r\n{\r\n    if(token)\r\n    {\r\n        let user\r\n        try {\r\n            user = jwt.verify(token, secret)\r\n        } catch(err)\r\n        {\r\n            return false\r\n        }\r\n        return user\r\n    }\r\n    return false\r\n}\n\n\n// WEBPACK FOOTER //\n// ./config/jwt.ts","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 10\n// module chunks = 0","import { Middleware, MiddlewareInterface } from 'routing-controllers';\nimport { UserAttribute } from '../models/User';\nimport { Context } from 'koa';\nimport { verifyToken } from '../config/jwt';\nimport { AuthMiddleware } from './AuthMiddleware';\n\n\n@Middleware()\nexport class AdminMiddleware implements MiddlewareInterface {\n    use(context: Context, next: (err?: any) => Promise<any>): Promise<any> | null {\n        if (context.request.user && context.request.user.isAdmin) \n        {\n            return next()\n        }\n        context.response.status = 403\n        context.response.body = '403 Forbidden'\n        return\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AdminMiddleware.ts","import { MiddlewareGlobalBefore, MiddlewareInterface} from 'routing-controllers';\nimport {Context} from 'koa'\nimport {Response} from '~koa/lib/response'\n\nconst pug = require('pug');\nconst path = require('path');\nconst defaults = require('lodash.defaults');\n\n@MiddlewareGlobalBefore()\nexport class PugMiddleware implements MiddlewareInterface {\n\n    use(ctx: Context, next: (err?: any) => Promise<any>): Promise<any> | null \n\t    {\n\t        ctx.response.render = function (file) {\n\t        ctx.body = pug.renderFile(path.resolve('./views', file + '.pug'), defaults({}))\n\t    }\n\t    return next()\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/PugMiddleware.ts","module.exports = require(\"pug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pug\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"lodash.defaults\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash.defaults\"\n// module id = 15\n// module chunks = 0","import { JsonController, Post, Body, Req, Res, Get, Controller, UseBefore } from 'routing-controllers';\nimport { UserAttribute, UserModel } from '../models/User';\nimport User from '../models/User';\nimport { generateToken } from '../config/jwt';\nimport { Request } from '~koa/lib/request';\nimport { Response } from '~koa/lib/response';\nimport { PugMiddleware } from '../middlewares/PugMiddleware';\n\n\n@JsonController()\nexport class AuthController {\n    @Get('/login')\n    login( @Res() res: Response) {\n        res.render('auth/login')\n    }\n\n    @Post('/login')\n    async postLogin( @Body() user: UserAttribute): Promise<any> {\n        const found = await User.findOne({\n            where: {\n                email: user.email\n            }\n        })\n        if (found && found.password == user.password)\n            return { success: true, token: generateToken(found.dataValues) }\n        else\n            return { success: false, message: 'Incorrect password or username' }\n\n    }\n\n\n    @Post(\"/register\")\n    async register( @Body() user: UserAttribute) {\n        return await User.create(user, { raw: true })\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/AuthController.ts","import { Controller, UseBefore, Get, Res, JsonController } from 'routing-controllers';\nimport { PugMiddleware } from '../middlewares/PugMiddleware';\nimport { Response } from '~koa/lib/response';\n\n@JsonController()\nexport class FeedController {\n    @Get('/')\n    async home( @Res() res: Response) {\n        res.render('index')\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/FeedController.ts","module.exports = require(\"koa-convert\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-convert\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"koa-static-folder\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static-folder\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"koa-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-cors\"\n// module id = 21\n// module chunks = 0","import { MiddlewareGlobalBefore, MiddlewareInterface } from 'routing-controllers';\nimport { Context } from 'koa'\n\n@MiddlewareGlobalBefore()\nexport class CookieMiddleware implements MiddlewareInterface {\n\n    use(context: Context, next: (err?: any) => Promise<any>): Promise<any> | null {\n        const cookieHeader = context.headers.cookie;\n        if (cookieHeader) {\n            const cookies = cookieHeader.split(';');\n            context.cookie = {};\n            cookies.forEach(function (item) {\n                const crumbs = item.split('=');\n                if (crumbs.length > 1) context.cookie[crumbs[0].trim()] = crumbs[1].trim();\n            });\n        }\n        return next()\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/CookieMiddleware.ts"],"sourceRoot":""}