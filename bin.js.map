{"version":3,"sources":["webpack/bootstrap d6a3b1b43e0f66f15cf6","D:\\mcreactor\\app.ts","external \"es6-shim\"","external \"reflect-metadata\"","external \"koa\"","external \"koa-router\"","D:\\mcreactor\\controllers\\AuthController.ts","D:\\mcreactor\\models\\models.ts","D:\\mcreactor\\models\\CommentaryRate.ts","D:\\mcreactor\\config\\db.ts","external \"sequelize\"","D:\\mcreactor\\models\\PostRate.ts","D:\\mcreactor\\models\\Post.ts","D:\\mcreactor\\models\\Commentary.ts","D:\\mcreactor\\models\\Tag.ts","D:\\mcreactor\\models\\User.ts","D:\\mcreactor\\models\\Subscription.ts","D:\\mcreactor\\models\\Ban.ts","D:\\mcreactor\\mocks\\users.ts","external \"fs\"","external \"sha256\"","D:\\mcreactor\\config\\jwt.ts","external \"jsonwebtoken\"","D:\\mcreactor\\controllers\\FeedController.ts","external \"koa-multer\"","D:\\mcreactor\\controllers\\UserController.ts","D:\\mcreactor\\middlewares\\AuthMiddleware.ts","D:\\mcreactor\\middlewares\\AdminMiddleware.ts","D:\\mcreactor\\controllers\\PostController.ts","D:\\mcreactor\\lib\\post.ts","D:\\mcreactor\\controllers\\CommentController.ts","D:\\mcreactor\\controllers\\TagController.ts","external \"path\"","external \"koa-convert\"","external \"koa-static\"","external \"koa-bodyparser\"","external \"koa-cors\"","external \"koa-logger\"","D:\\mcreactor\\config\\pug.ts","external \"koa-pug\"","external \"koa-json\"","D:\\mcreactor\\middlewares\\CookieMiddleware.ts"],"names":[],"mappings":"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","file":"bin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d6a3b1b43e0f66f15cf6","import 'es6-shim'\r\nimport \"reflect-metadata\";\r\nimport * as Koa from \"koa\"\r\nimport * as Router from 'koa-router'\r\nimport AuthController from './controllers/AuthController'\r\nimport FeedController from './controllers/FeedController'\r\nimport UserController from './controllers/UserController'\r\nimport PostController from './controllers/PostController'\r\nimport CommentController from './controllers/CommentController'\r\nimport TagController from './controllers/TagController'\r\nimport { Context } from 'koa';\r\n\r\nconst path = require('path')\r\n\r\nconst convert = require('koa-convert')\r\n\r\nconst serve = require('koa-static')\r\n\r\nconst app = new Koa()\r\n\r\napp.use(require('koa-bodyparser')())\r\n\r\napp.use(convert(serve('./public')))\r\n// app.use(convert(serve('./public/images')))\r\n\r\nlet cors = require('koa-cors')\r\nlet logger = require('koa-logger')\r\n\r\napp.use(convert(logger()))\r\n\r\napp.use(convert(cors()))\r\n\r\nimport pug from './config/pug'\r\n\r\npug.use(app)\r\n\r\napp.use(convert(require('koa-json')()))\r\n\r\nimport cookieMiddleware from './middlewares/CookieMiddleware';\r\n\r\napp.use(cookieMiddleware)\r\n\r\nconst router = new Router()\r\n\r\n\r\nrouter\r\n    .use('',UserController.routes())\r\n    .use('',AuthController.routes())\r\n    .use('',FeedController.routes())\r\n    .use('',PostController.routes())\r\n    .use('',CommentController.routes())\r\n    .use('',TagController.routes())\r\n\r\napp\r\n    .use(router.routes())\r\n    .use(router.allowedMethods())\r\n\r\napp.listen(3000)\r\n\n\n\n// WEBPACK FOOTER //\n// ./app.ts","module.exports = require(\"es6-shim\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-shim\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"reflect-metadata\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"reflect-metadata\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 4\n// module chunks = 0","import { UserAttribute, UserModel } from '../models/User';\r\nimport { User, Subscription } from '../models/models';\r\nimport { generateToken } from '../config/jwt';\r\nimport { Request } from '~koa/lib/request';\r\nimport { Response } from '~koa/lib/response';\r\nimport * as Router from 'koa-router'\r\nimport { Context } from 'koa';\r\n\r\nconst hash = require('sha256')\r\n\r\nconst AuthController = new Router()\r\n\r\nAuthController\r\n\r\n    .get('/login',\r\n    (ctx: Context) => {\r\n        ctx.body = []\r\n    })\r\n\r\n    .post('/login',\r\n    async (ctx: Context): Promise<any> => {\r\n        const user = ctx.request.body\r\n        const found = await User.findOne({\r\n            where: {\r\n                email: user.email\r\n            },\r\n            include:[\r\n                Subscription\r\n            ]\r\n        })\r\n        if (found && found.password == hash(user.password))\r\n            ctx.body =  { success: true, token: generateToken(found.dataValues) }\r\n        else if (!found)\r\n            ctx.body =  { success: false, message: 'Wrong email' }\r\n        else\r\n            ctx.body = { success: false, message: 'Wrong password' }\r\n    })\r\n\r\n    .get('/register',\r\n    async (ctx: Context) => {\r\n        ctx.body = []\r\n    })\r\n    \r\n    .post('/register',\r\n    async (ctx: Context) => {\r\n        let user = ctx.request.body\r\n        if (user.password != user.confirmPassword)\r\n            ctx.body = { success: false, message: 'Passwords do not match' }\r\n        user.password = hash(user.password)\r\n        try {\r\n            let createdUser = await User.create(user)\r\n        }\r\n        catch (err) {\r\n            console.log(err)\r\n            if (err.name == \"SequelizeUniqueConstraintError\")\r\n                ctx.body =  { success: false, message: 'Email busy' }\r\n            ctx.body =  { success: false, message: 'Some error' }\r\n        }\r\n        ctx.body =  { success: true, message: '' }\r\n    })\r\n\r\nexport default AuthController\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/AuthController.ts","import CommentaryRate from './CommentaryRate';\r\nimport PostRate from './PostRate';\r\nimport Post from './Post';\r\nimport Commentary from './Commentary';\r\nimport Tag from './Tag';\r\nimport User from './User';\r\nimport * as Sequelize from 'sequelize';\r\nimport db from '../config/db';\r\nimport Subscription from \"./Subscription\";\r\nimport Ban from \"./Ban\";\r\nimport users from \"../mocks/users\";\r\nimport * as fs from 'fs';\r\n\r\nPost.belongsTo(User)\r\n\r\nUser.hasMany(Post)\r\n\r\nUser.hasMany(Commentary)\r\n\r\nCommentary.belongsTo(User)\r\n\r\nPost.hasMany(Commentary, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nCommentary.belongsTo(Post)\r\n\r\nconst PostTag = db.define('PostTag', {}, {tableName: 'PostTag'})\r\n\r\nTag.belongsToMany(Post, {through: 'PostTag'})\r\n\r\nPost.belongsToMany(Tag, {through: 'PostTag'})\r\n\r\nPostRate.belongsTo(Post)\r\n\r\nPostRate.belongsTo(User)\r\n\r\nPost.hasMany(PostRate, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nCommentaryRate.belongsTo(Commentary)\r\n\r\nCommentaryRate.belongsTo(User)\r\n\r\nCommentary.hasMany(CommentaryRate, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nSubscription.belongsTo(User)\r\n\r\nSubscription.belongsTo(Tag)\r\n\r\nUser.hasMany(Subscription, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nTag.hasMany(Subscription, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nBan.belongsTo(User)\r\n\r\nBan.belongsTo(Tag)\r\n\r\nUser.hasMany(Ban, {\r\n    onDelete: 'CASCADE'\r\n})\r\n\r\nTag.hasMany(Ban)\r\n\r\n;(async() => {\r\n    await User.sync({force: true})\r\n    await Post.sync({force: true})\r\n    await Tag.sync({force: true})\r\n    await PostTag.sync({force: true})\r\n    await Commentary.sync({force: true})\r\n    await PostRate.sync({force: true})\r\n    await CommentaryRate.sync({force: true})\r\n    await Ban.sync({force: true})\r\n    await Subscription.sync({force: true})\r\n    \r\n    \r\n    ;(async() => {\r\n        await User.bulkCreate(users.map(user => {\r\n            user.password = require('sha256')(user.password)\r\n            return user\r\n        }))\r\n        let query = fs.readFileSync('./mocks/posts.sql', 'utf-8')\r\n        await db.query(query)\r\n        query = fs.readFileSync('./mocks/Tags.sql', 'utf-8')\r\n        await db.query(query)\r\n        query = fs.readFileSync('./mocks/PostTag.sql', 'utf-8')\r\n        await query.split(';').forEach(async (command) => {\r\n            if(command != '')\r\n                await db.query(command)\r\n        })\r\n        query = fs.readFileSync('./mocks/Commentaries.sql', 'utf-8')\r\n        await query.split(';').forEach(async (command) => {\r\n            if(command != '')\r\n                await db.query(command)\r\n        })\r\n    })()\r\n})()\r\n\r\nexport {Tag, Commentary, Post, User, CommentaryRate, PostRate, Ban, Subscription}\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/models.ts","import { CommentaryInstance } from './Commentary';\r\nimport { UserInstance } from './User';\r\n/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from 'sequelize';\r\n\r\nexport interface CommentaryRateAttribute {\r\n    id?: number\r\n    rate: number\r\n    User?: UserInstance\r\n    Commentary?: CommentaryInstance\r\n}\r\n\r\nexport interface CommentaryRateInstance extends Sequelize.Instance<CommentaryRateAttribute>, CommentaryRateAttribute\r\n{ }\r\n\r\nexport interface CommentaryRateModel extends Sequelize.Model<CommentaryRateInstance, CommentaryRateAttribute>\r\n{ }\r\n\r\nconst CommentaryRate: CommentaryRateModel = db.define<CommentaryRateInstance, CommentaryRateAttribute>(\"CommentaryRate\", {\r\n    rate: {\r\n        type: Sequelize.INTEGER(2),\r\n        allowNull: false,\r\n    }\r\n}, {\r\n        timestamps: true\r\n})\r\n\r\n\r\nexport default CommentaryRate\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/CommentaryRate.ts","/**\r\n * Created by Monyk on 05.11.2016.\r\n */\r\nimport * as Sequelize from 'sequelize'\r\n\r\nconst db : Sequelize.Sequelize = new Sequelize('mysql://root:root@db/mcreactor', {\r\n    dialectOptions: {\r\n        multipleStatements: true\r\n    }\r\n})\r\n\r\nexport default db\r\n\n\n\n// WEBPACK FOOTER //\n// ./config/db.ts","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 9\n// module chunks = 0","import { PostInstance } from './Post';\r\nimport { UserInstance } from './User';\r\n/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\n\r\nexport interface PostRateAttribute {\r\n    id?: number\r\n    rate?: number\r\n    User?:UserInstance\r\n    Post?:PostInstance\r\n}\r\n\r\nexport interface PostRateInstance extends Sequelize.Instance<PostRateAttribute>, PostRateAttribute\r\n{ }\r\n\r\nexport interface PostRateModel extends Sequelize.Model<PostRateInstance, PostRateAttribute>\r\n{ }\r\n\r\nconst PostRate: PostRateModel = db.define<PostRateInstance, PostRateAttribute>(\"PostRate\", {\r\n    rate: {\r\n        type: Sequelize.INTEGER(2),\r\n        allowNull: false,\r\n    }\r\n}, {\r\n        timestamps: true\r\n})\r\n\r\n\r\nexport default PostRate\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/PostRate.ts","import { UserInstance } from './User';\r\n/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\n\r\nexport interface PostAttribute {\r\n    id?: number\r\n    content?: String\r\n    image?: String\r\n    createdAt?: number\r\n    updatedAt?: number\r\n    Tags?: Array<any>\r\n    UserId?: number\r\n    rating?: number\r\n    getTags?: any\r\n    User?: UserInstance\r\n}\r\n\r\nexport interface PostInstance extends Sequelize.Instance<PostAttribute>, PostAttribute\r\n{ }\r\n\r\nexport interface PostModel extends Sequelize.Model<PostInstance, PostAttribute>\r\n{ }\r\n\r\nconst Post: PostModel = db.define<PostInstance, PostAttribute>(\"Post\", {\r\n    content: {\r\n        type: Sequelize.TEXT,\r\n        allowNull: false,\r\n    },\r\n    image: {\r\n        type: Sequelize.STRING,\r\n        allowNull: true\r\n    },\r\n    rating: {\r\n        type: Sequelize.INTEGER,\r\n        defaultValue: 0\r\n    }\r\n}, {\r\n        timestamps: true\r\n    })\r\n\r\nexport default Post\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Post.ts","import { UserInstance } from './User';\r\n/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\n\r\n\r\nexport interface CommentaryAttribute\r\n{\r\n    id?:number\r\n    content?:any\r\n    createdAt?:number\r\n    updatedAt?:number\r\n    rating?:number\r\n    User?:UserInstance\r\n}\r\n\r\nexport interface CommentaryInstance extends Sequelize.Instance<CommentaryAttribute>, CommentaryAttribute\r\n{}\r\n\r\nexport interface CommentaryModel extends Sequelize.Model<CommentaryInstance, CommentaryAttribute>\r\n{}\r\n\r\nconst Commentary : CommentaryModel = db.define<CommentaryInstance, CommentaryAttribute>(\"Commentary\", {\r\n    content: {\r\n        type: Sequelize.TEXT,\r\n        allowNull: false,\r\n    },\r\n    rating: {\r\n        type: Sequelize.INTEGER,\r\n        allowNull: true,\r\n        defaultValue:0\r\n    }\r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\nexport default Commentary\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Commentary.ts","/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\n\r\nexport interface TagAttribute\r\n{\r\n    id?:number\r\n    name: string\r\n    createdAt?:number\r\n    updatedAt?:number\r\n}\r\n\r\nexport interface TagInstance extends Sequelize.Instance<TagAttribute>, TagAttribute\r\n{}\r\n\r\nexport interface TagModel extends Sequelize.Model<TagInstance, TagAttribute>\r\n{}\r\n\r\nconst Tag : TagModel = db.define<TagInstance, TagAttribute>(\"Tag\", {\r\n    name: {\r\n        type: Sequelize.STRING,\r\n        allowNull: false,\r\n        unique: true\r\n    }\r\n}, {\r\n    indexes:[\r\n        {\r\n            fields: ['name'],\r\n            unique: true\r\n        }\r\n    ],\r\n    timestamps: true,\r\n})\r\n\r\n\r\nexport default Tag\r\n\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Tag.ts","/**\r\n * Created by Monyk on 06.11.2016.\r\n */\r\nimport db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\n\r\nexport interface UserAttribute\r\n{\r\n    id?:number\r\n    nickname?:string\r\n    email?:string\r\n    password?:string\r\n    rating?:number\r\n    isBanned?:boolean\r\n    isAdmin?:boolean\r\n    createdAt?:number\r\n    updatedAt?:number\r\n}\r\n\r\nexport interface UserInstance extends Sequelize.Instance<UserAttribute>, UserAttribute\r\n{}\r\n\r\nexport interface UserModel extends Sequelize.Model<UserInstance, UserAttribute>\r\n{}\r\n\r\nconst User : UserModel = db.define<UserInstance, UserAttribute>(\"User\", {\r\n    nickname: {\r\n        type: Sequelize.STRING(30),\r\n        allowNull: false,\r\n    },\r\n    email: {\r\n        type: Sequelize.STRING(50),\r\n        allowNull: false,\r\n        unique: true\r\n    },\r\n    password: {\r\n        type: Sequelize.STRING(100),\r\n        allowNull: false\r\n    },\r\n    rating: {\r\n        type: Sequelize.INTEGER\r\n    },\r\n    isBanned: {\r\n        type: Sequelize.BOOLEAN,\r\n        allowNull: true\r\n    },\r\n    isAdmin: {\r\n        type: Sequelize.BOOLEAN,\r\n        allowNull: true\r\n        \r\n    },\r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\n\r\nexport default User\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/User.ts","import db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\nimport {TagInstance} from \"./Tag\";\r\nimport {UserInstance} from './User';\r\n\r\n\r\nexport interface SubscriptionAttribute\r\n{\r\n    id?: number\r\n    User?:UserInstance\r\n    Tag?:TagInstance\r\n    createdAt?:number\r\n    updatedAt?:number\r\n    UserId?:number\r\n    TagId?:number\r\n}\r\n\r\nexport interface SubscriptionInstance extends Sequelize.Instance<SubscriptionAttribute>, SubscriptionAttribute\r\n{}\r\n\r\nexport interface SubscriptionModel extends Sequelize.Model<SubscriptionInstance, SubscriptionAttribute>\r\n{}\r\n\r\nconst Subscription : SubscriptionModel = db.define<SubscriptionInstance, SubscriptionAttribute>(\"Subscription\", {\r\n    \r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\nexport default Subscription\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Subscription.ts","import db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\nimport {TagInstance} from \"./Tag\";\r\nimport {UserInstance} from './User';\r\n\r\n\r\nexport interface BanAttribute\r\n{\r\n    id?: number\r\n    User?:UserInstance\r\n    Tag?:TagInstance\r\n    createdAt?:number\r\n    updatedAt?:number\r\n    UserId?:number\r\n    TagId?:number\r\n}\r\n\r\nexport interface BanInstance extends Sequelize.Instance<BanAttribute>, BanAttribute\r\n{}\r\n\r\nexport interface BanModel extends Sequelize.Model<BanInstance, BanAttribute>\r\n{}\r\n\r\nconst Ban : BanModel = db.define<BanInstance, BanAttribute>(\"Ban\", {\r\n\r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\nexport default Ban\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Ban.ts","const users = [{\r\n    \"isAdmin\": true,\r\n    \"rating\": 21,\r\n    \"isBanned\": null,\r\n    \"email\": \"admin@gmail.com\",\r\n    \"nickname\": \"admin\",\r\n    \"password\": \"admin\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 87,\r\n    \"isBanned\": null,\r\n    \"email\": \"jburton1@smugmug.com\",\r\n    \"nickname\": \"cramos1\",\r\n    \"password\": \"aAJfgYUpMgs\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 42,\r\n    \"isBanned\": null,\r\n    \"email\": \"kday2@photobucket.com\",\r\n    \"nickname\": \"jprice2\",\r\n    \"password\": \"fQ7IZbm\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 12,\r\n    \"isBanned\": false,\r\n    \"email\": \"gyoung3@dyndns.org\",\r\n    \"nickname\": \"dpierce3\",\r\n    \"password\": \"za5DeM\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 96,\r\n    \"isBanned\": null,\r\n    \"email\": \"gburns4@smugmug.com\",\r\n    \"nickname\": \"jclark4\",\r\n    \"password\": \"SyAHlw8L69K2\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 67,\r\n    \"isBanned\": null,\r\n    \"email\": \"smorales5@godaddy.com\",\r\n    \"nickname\": \"ralvarez5\",\r\n    \"password\": \"54QgRT2OHLJC\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 41,\r\n    \"isBanned\": null,\r\n    \"email\": \"kmoreno6@seesaa.net\",\r\n    \"nickname\": \"lmurray6\",\r\n    \"password\": \"aS1ZtShNaph\"\r\n}, {\r\n    \r\n    \"isAdmin\": false,\r\n    \"rating\": 24,\r\n    \"isBanned\": null,\r\n    \"email\": \"aferguson7@google.com\",\r\n    \"nickname\": \"mnguyen7\",\r\n    \"password\": \"3DQeUgDK\"\r\n}]\r\n\r\nexport default users\n\n\n// WEBPACK FOOTER //\n// ./mocks/users.ts","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"sha256\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sha256\"\n// module id = 19\n// module chunks = 0","import { UserAttribute } from '../models/User';\r\nconst jwt = require('jsonwebtoken')\r\n\r\nconst secret = 'veryverysecret'\r\n\r\nexport function generateToken(user : UserAttribute) : string\r\n{\r\n    return jwt.sign(user, secret)\r\n}\r\n\r\nexport function verifyToken(token : string | undefined) : UserAttribute | false\r\n{\r\n    if(token)\r\n    {\r\n        let user\r\n        try {\r\n            user = jwt.verify(token, secret)\r\n        } catch(err)\r\n        {\r\n            return false\r\n        }\r\n        return user\r\n    }\r\n    return false\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./config/jwt.ts","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 21\n// module chunks = 0","import authMiddleware from '../middlewares/AuthMiddleware';\r\n\r\nimport { Response } from '~koa/lib/response';\r\nimport { User, Commentary, Tag, Post } from '../models/models';\r\nimport * as Router from 'koa-router';\r\nimport { Context } from 'koa';\r\nimport db from '../config/db';\r\n\r\n\r\nconst multer = require('koa-multer')\r\nconst upload = multer({ dest: './public/images' })\r\n\r\nconst FeedController = new Router()\r\n\r\nFeedController\r\n\r\n    .get('/',\r\n    (ctx: Context) => {\r\n        ctx.render('index')\r\n    })\r\n\r\n\r\n\r\nexport default FeedController\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/FeedController.ts","module.exports = require(\"koa-multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-multer\"\n// module id = 23\n// module chunks = 0","/**\r\n * Created by Monyk on 05.11.2016.\r\n */\r\n\r\nimport * as Router from 'koa-router';\r\nimport {Context} from 'koa';\r\nimport {User, Subscription, Tag, Ban, Post} from '../models/models';\r\nimport authMiddleware from '../middlewares/AuthMiddleware';\r\nimport getPosts from \"../lib/post\";\r\nimport adminMiddleware from \"../middlewares/AdminMiddleware\";\r\n\r\nconst UserController = new Router()\r\n\r\n// UserController.use(authMiddleware)\r\n\r\nUserController\r\n    \r\n    .get('/user',\r\n        authMiddleware(),\r\n        async(ctx: Context) => {\r\n            ctx.body = await User.findAll({raw: true, order: 'id'})\r\n        })\r\n    \r\n    .get('/user/:id',\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            ctx.body = await User.findById(id)\r\n        })\r\n    \r\n    .put('/user/:id',\r\n        async(ctx: Context) => {\r\n            let id = ctx.params.id\r\n            let user = ctx.request.body\r\n            const foundUser = await User.findById(id)\r\n            if (foundUser)\r\n            {\r\n                ctx.body = (await foundUser.update(user)).get()\r\n            }\r\n            ctx.body = {success: false, message: 'User not found'}\r\n        })\r\n    \r\n    .get('/user/:id/subscriptions',\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            let subscriptions = await Subscription.findAll({\r\n                where: {\r\n                    UserId: id\r\n                },\r\n                include: [Tag]\r\n            })\r\n            let bans = await Ban.findAll({\r\n                where: {\r\n                    UserId: id\r\n                },\r\n                include: [Tag]\r\n            })\r\n            ctx.body = {success: true, subscriptions: subscriptions, bans: bans}\r\n        })\r\n    \r\n    .get('/user/:id/tag/:tagId/subscribe',\r\n        async(ctx) => {\r\n            try\r\n            {\r\n                let userId = ctx.params.id\r\n                let tagId = ctx.params.tagId\r\n                await Ban.destroy({\r\n                    where: {\r\n                        UserId: userId,\r\n                        TagId: tagId\r\n                    }\r\n                })\r\n                await Subscription.create({\r\n                    UserId: userId,\r\n                    TagId: tagId\r\n                })\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: 'Something went wrong'}\r\n                return\r\n            }\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .get('/user/:id/tag/:tagId/unsubscribe',\r\n        async(ctx) => {\r\n            try\r\n            {\r\n                let userId = ctx.params.id\r\n                let tagId = ctx.params.tagId\r\n                await Subscription.destroy({\r\n                    where: {\r\n                        UserId: userId,\r\n                        TagId: tagId\r\n                    }\r\n                })\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: 'Something went wrong'}\r\n                return\r\n            }\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .get('/user/:id/tag/:tagId/ban',\r\n        async(ctx) => {\r\n            try\r\n            {\r\n                let userId = ctx.params.id\r\n                let tagId = ctx.params.tagId\r\n                await Subscription.destroy({\r\n                    where: {\r\n                        UserId: userId,\r\n                        TagId: tagId\r\n                    }\r\n                })\r\n                await Ban.create({\r\n                    UserId: userId,\r\n                    TagId: tagId\r\n                })\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: 'Something went wrong'}\r\n                return\r\n            }\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .get('/user/:id/tag/:tagId/unban',\r\n        async(ctx) => {\r\n            try\r\n            {\r\n                let userId = ctx.params.id\r\n                let tagId = ctx.params.tagId\r\n                await Ban.destroy({\r\n                    where: {\r\n                        UserId: userId,\r\n                        TagId: tagId\r\n                    }\r\n                })\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: 'Something went wrong'}\r\n                return\r\n            }\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .get('/user/:id/ban',\r\n        authMiddleware(),\r\n        adminMiddleware,\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            await User.update({\r\n                isBanned: true\r\n            }, {\r\n                where: {\r\n                    id: id\r\n                }\r\n            })\r\n            await Post.destroy({\r\n                where: {\r\n                    UserId: id\r\n                }\r\n            })\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .get('/user/:id/unban',\r\n        authMiddleware(),\r\n        adminMiddleware,\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            await User.update({\r\n                isBanned: false\r\n            }, {\r\n                where: {\r\n                    id: id\r\n                }\r\n            })\r\n            ctx.body = {success: true}\r\n        })\r\n\r\nexport default UserController\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/UserController.ts","import {Context} from 'koa'\r\nimport {UserAttribute} from '../models/User';\r\nimport {verifyToken} from '../config/jwt';\r\n\r\n\r\nconst authMiddleware = (allowNotLoggedIn: boolean = false) => {\r\n    return (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\r\n        let token = false\r\n        if (context.cookie)\r\n            token = context.cookie.token\r\n        if (token)\r\n        {\r\n            const user: UserAttribute | boolean = verifyToken(token.toString())\r\n            if (user)\r\n            {\r\n                context.user = user\r\n                return next()\r\n            }\r\n        }\r\n        context.user = null\r\n        \r\n        if (!allowNotLoggedIn)\r\n        {\r\n            context.response.status = 403\r\n            context.response.body = '403 Forbidden'\r\n            return\r\n        }\r\n        else\r\n        {\r\n            return next()\r\n        }\r\n    }\r\n}\r\n\r\nexport default authMiddleware\r\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AuthMiddleware.ts","import { Context } from 'koa';\r\n\r\n const adminMiddleware = (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\r\n        if (context.user && context.user.isAdmin) \r\n        {\r\n            return next()\r\n        }\r\n        context.status = 403\r\n        context.body = '403 Forbidden'\r\n        return\r\n    }\r\n\r\nexport default adminMiddleware\r\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AdminMiddleware.ts","import PostRate from '../models/PostRate';\r\nimport db from '../config/db';\r\nimport authMiddleware from '../middlewares/AuthMiddleware';\r\nimport {Commentary, Tag, User, Post} from '../models/models';\r\nimport {Context} from '~koa/lib/context';\r\nimport * as Router from 'koa-router';\r\nimport getPosts from \"../lib/post\";\r\nimport adminMiddleware from \"../middlewares/AdminMiddleware\";\r\n\r\nconst PostController = new Router()\r\n\r\nconst multer = require('koa-multer')\r\nconst upload = multer({dest: './public/images'})\r\n\r\nPostController\r\n    \r\n    .post('/post',\r\n        upload.single('image'),\r\n        authMiddleware(),\r\n        async(ctx: Context) => {\r\n            try\r\n            {\r\n                let userId = ctx.user.id\r\n                let tags = ctx.req.body.tags\r\n                              .split(',')\r\n                              .filter(tag => tag != '')\r\n                              .map(tag => {\r\n                                  return {'name': tag.trim()}\r\n                              })\r\n                \r\n                let image = ctx.req.file ? ctx.req.file.filename : null\r\n                \r\n                let post = await Post.create({\r\n                    content: ctx.req.body.content,\r\n                    image: image,\r\n                    UserId: userId\r\n                }) as any\r\n                \r\n                if (tags.length)\r\n                {\r\n                    await Tag.bulkCreate(tags, {\r\n                        updateOnDuplicate: ['name']\r\n                    })\r\n                    \r\n                    await post.setTags(await Tag.findAll({\r\n                        where: {\r\n                            name: {\r\n                                in: ctx.req.body.tags.split(',').map(tag => tag.trim())\r\n                            }\r\n                        }\r\n                    }))\r\n                }\r\n                ctx.body = {success: true, message: ''}\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: `Something went wrong: ${e}`}\r\n            }\r\n        })\r\n    \r\n    .get('/post/:id',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            const id = ctx.params.id\r\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, {\r\n                id: id\r\n            })\r\n        })\r\n    \r\n    .get('/post',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\r\n                    id: {\r\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\r\n                    }\r\n                } : null) //exclude banned posts when user is logged in\r\n        })\r\n    \r\n    .get('/best',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\r\n                    id: {\r\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\r\n                    },\r\n                    rating: {\r\n                        $gte: 50\r\n                    }\r\n                } : {\r\n                    rating: {\r\n                        $gte: 50\r\n                    }\r\n                }) //exclude banned posts when user is logged in\r\n        })\r\n    \r\n    .get('/good',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\r\n                    id: {\r\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\r\n                    },\r\n                    rating: {\r\n                        $gte: 20\r\n                    }\r\n                } : {\r\n                    rating: {\r\n                        $gte: 20\r\n                    }\r\n                }) //exclude banned posts when user is logged in\r\n        })\r\n    \r\n    .get('/post/tag/:id',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            ctx.body = await getPosts(ctx.user.id, {\r\n                id: {\r\n                    $in: db.literal(\"(select `PostId` from `PostTag` where `TagId` = \" + id + \")\")\r\n                }\r\n            })\r\n        })\r\n    \r\n    .get('/post/user/subscribed',\r\n        authMiddleware(),\r\n        async(ctx) => {\r\n            let id = ctx.user.id\r\n            ctx.body = await getPosts(ctx.user.id, {\r\n                id: {\r\n                    $in: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Subscriptions` where `UserId` = \" + id + \"))\")\r\n                }\r\n            })\r\n        })\r\n    \r\n    //ajax rate route\r\n    .get('/post/:id/rate/:rate',\r\n        authMiddleware(),\r\n        async(ctx) => {\r\n            let id = ctx.params.id\r\n            let rate = ctx.params.rate\r\n            let previousRate = await PostRate.findOne({\r\n                where: {\r\n                    PostId: id,\r\n                    UserId: ctx.user.id\r\n                },\r\n                include: [Post, User]\r\n            })\r\n            if (previousRate)\r\n            {\r\n                previousRate.User.rating -= previousRate.rate\r\n                previousRate.Post.rating -= previousRate.rate\r\n                if (rate == 'neutral')\r\n                {\r\n                    await previousRate.destroy()\r\n                }\r\n                else\r\n                {\r\n                    previousRate.rate = (rate == 'like' ? 1 : -1)\r\n                    previousRate.User.rating += previousRate.rate\r\n                    previousRate.Post.rating += previousRate.rate\r\n                    await previousRate.save()\r\n                }\r\n                await previousRate.User.save()\r\n                await previousRate.Post.save()\r\n                ctx.body = {success: true, rating: previousRate.Post.rating}\r\n            }\r\n            else if (rate != 'neutral')\r\n            {\r\n                let newRate = await PostRate.create(<any>{\r\n                    rate: (rate == 'like' ? 1 : -1),\r\n                    UserId: ctx.user.id,\r\n                    PostId: id\r\n                })\r\n                let post = await Post.findById(id, {\r\n                    include: [User]\r\n                })\r\n                post.User.rating += newRate.rate\r\n                post.rating += newRate.rate\r\n                await newRate.save()\r\n                await post.save()\r\n                await post.User.save()\r\n                ctx.body = {success: true, rating: post.rating}\r\n            }\r\n            else\r\n            {\r\n                ctx.body = {success: true}\r\n            }\r\n        })\r\n    \r\n    \r\n    .get('/user/:id/profile',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            let userId = ctx.params.id\r\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, {\r\n                UserId: userId\r\n            })\r\n        })\r\n    \r\n    .get('/post/:id/delete',\r\n        authMiddleware(),\r\n        async(ctx) => {\r\n            let postId = ctx.params.id\r\n            await Post.destroy({\r\n                where: {\r\n                    id: postId\r\n                }\r\n            })\r\n            ctx.body = {success: true}\r\n        })\r\n    \r\n    .post('/post/filter',\r\n        authMiddleware(true),\r\n        async(ctx) => {\r\n            let filter = ctx.request.body\r\n            let whereClause: any = {}\r\n            if (filter.tagsArray && filter.tagsArray.length)\r\n            {\r\n                filter.tags = filter.tagsArray\r\n                                    .filter(tag => tag != '')\r\n                                    .map(tag => \"'\" + tag.trim() + \"'\")\r\n                whereClause.id = {\r\n                    $in: db.literal(\" (select `Posts`.`id` from `Posts` \" +\r\n                        \"where (select count(`TagId`) from `PostTag` inner join `Tags` on `Tags`.`id` = `PostTag`.`TagId` \" +\r\n                        \"where `PostTag`.`PostId` = `Posts`.`id` and `Tags`.`name` in (\" + filter.tags.join(',') + \") ) = \" + filter.tags.length + \" ) \")\r\n                }\r\n            }\r\n            if (filter.content)\r\n                whereClause.content = {\r\n                    $like: `%${filter.content}%`\r\n                }\r\n            if (filter.dateFrom || filter.dateTo)\r\n            {\r\n                whereClause.createdAt = {}\r\n                if (filter.dateFrom)\r\n                    whereClause.createdAt.$gte = new Date(filter.dateFrom)\r\n                if (filter.dateTo)\r\n                {\r\n                    let date = new Date(filter.dateTo)\r\n                    date.setHours(23, 59, 59, 0)\r\n                    whereClause.createdAt.$lte = date\r\n                }\r\n            }\r\n            if (filter.ratingTo || filter.ratingFrom)\r\n            {\r\n                whereClause.rating = {}\r\n                if (filter.ratingTo)\r\n                    whereClause.rating.$lte = filter.ratingTo\r\n                if (filter.ratingFrom)\r\n                    whereClause.rating.$gte = filter.ratingFrom\r\n            }\r\n            console.log(whereClause)\r\n            let posts = await getPosts(ctx.user ? ctx.user.id : null, whereClause)\r\n            ctx.body = {success: true, posts}\r\n        })\r\n    \r\n    .get('/stats',\r\n        authMiddleware(),\r\n        adminMiddleware,\r\n        async(ctx) => {\r\n            let postCountByDay = await Post.findAll({\r\n                attributes: [db.fn('date', db.col('createdAt')), db.fn('count', 'id')],\r\n                group: [db.fn('date', db.col('createdAt'))],\r\n                raw: true\r\n            })\r\n            let commentCountByDay = await Commentary.findAll({\r\n                attributes: [db.fn('date', db.col('createdAt')), db.fn('count', 'id')],\r\n                group: [db.fn('date', db.col('createdAt'))],\r\n                raw: true\r\n            })\r\n            \r\n            let ratingCountByTag = await db.query(\"SELECT `Tag`.`name` as 'name', sum(`Posts`.`rating`) as 'rating'\" +\r\n                \" FROM `Tags` AS `Tag` LEFT OUTER JOIN (`PostTag` AS `Posts.PostTag` INNER JOIN `Posts` AS `Posts` ON `Posts`.`id` = `Posts.PostTag`.`PostId`)\" +\r\n                \" ON `Tag`.`id` = `Posts.PostTag`.`TagId` GROUP BY `Tag`.`id`;\")\r\n            \r\n            let ratingAvgByTag = await db.query(\"SELECT `Tag`.`name` as 'name', avg(`Posts`.`rating`) as 'rating'\" +\r\n                \" FROM `Tags` AS `Tag` LEFT OUTER JOIN (`PostTag` AS `Posts.PostTag` INNER JOIN `Posts` AS `Posts` ON `Posts`.`id` = `Posts.PostTag`.`PostId`)\" +\r\n                \" ON `Tag`.`id` = `Posts.PostTag`.`TagId` GROUP BY `Tag`.`id`;\")\r\n            \r\n            ctx.body = {postCountByDay, commentCountByDay, ratingCountByTag, ratingAvgByTag}\r\n        })\r\n\r\nexport default PostController\n\n\n// WEBPACK FOOTER //\n// ./controllers/PostController.ts","import {Commentary, Post, PostRate, Tag, User,CommentaryRate} from \"../models/models\";\r\n\r\nasync function getPosts(userId = null, where = null) {\r\n    return await Post.findAll({\r\n        where,\r\n        include: [\r\n            {\r\n                model: PostRate,\r\n                where: userId ? {\r\n                        UserId: userId\r\n                    } : null,\r\n                required: false\r\n            },\r\n            Tag,\r\n            User,\r\n            {\r\n                model: Commentary,\r\n                include: [User, {\r\n                    model: CommentaryRate,\r\n                    where: userId ? {\r\n                            UserId: userId\r\n                        } : null,\r\n                    required: false\r\n                }]\r\n            }\r\n        ],\r\n        order: [\r\n            ['createdAt', 'DESC'],\r\n            [Tag, 'name'],\r\n            [Commentary, 'createdAt']\r\n        ]\r\n    })\r\n}\r\n\r\nexport default getPosts\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/post.ts","import authMiddleware from '../middlewares/AuthMiddleware';\r\nimport {Commentary, CommentaryRate, Tag, User, Post} from '../models/models';\r\nimport {Context} from '~koa/lib/context';\r\nimport * as Router from 'koa-router';\r\n\r\nconst CommentController = new Router()\r\n\r\nCommentController\r\n    \r\n    .post('/post/:id/comment',\r\n        authMiddleware(),\r\n        async(ctx) =>\r\n        {\r\n            try\r\n            {\r\n                let commentary = ctx.request.body\r\n                commentary.PostId = ctx.params.id\r\n                commentary.UserId = ctx.user.id\r\n                await Commentary.create(commentary)\r\n                let comments = await Commentary.findAll({\r\n                    where: {\r\n                        PostId: commentary.PostId\r\n                    },\r\n                    include: [User]\r\n                })\r\n                ctx.body = {success: true, message: 'comment created', comments: comments}\r\n            }\r\n            catch (e)\r\n            {\r\n                ctx.body = {success: false, message: `something went wrong: ${e}`}\r\n            }\r\n        })\r\n    \r\n    .get('/comment/:id/rate/:rate',\r\n        authMiddleware(),\r\n        async(ctx) =>\r\n        {\r\n            let id = ctx.params.id\r\n            let rate = ctx.params.rate\r\n            let previousRate = await CommentaryRate.findOne({\r\n                where: {\r\n                    CommentaryId: id,\r\n                    UserId: ctx.user.id\r\n                },\r\n                include: [Commentary, User]\r\n            })\r\n            if (previousRate)\r\n            {\r\n                previousRate.User.rating -= previousRate.rate\r\n                previousRate.Commentary.rating -= previousRate.rate\r\n                if (rate == 'neutral')\r\n                {\r\n                    await previousRate.destroy()\r\n                }\r\n                else\r\n                {\r\n                    previousRate.rate = (rate == 'like' ? 1 : -1)\r\n                    previousRate.User.rating += previousRate.rate\r\n                    previousRate.Commentary.rating += previousRate.rate\r\n                    await previousRate.save()\r\n                }\r\n                await previousRate.User.save()\r\n                await previousRate.Commentary.save()\r\n                ctx.body = {success: true, rating: previousRate.Commentary.rating}\r\n            }\r\n            else if (rate != 'neutral')\r\n            {\r\n                let newRate = await CommentaryRate.create(<any>{\r\n                    rate: (rate == 'like' ? 1 : -1),\r\n                    UserId: ctx.user.id,\r\n                    CommentaryId: id\r\n                })\r\n                let commentary = await Commentary.findById(id, {\r\n                    include: [User]\r\n                })\r\n                commentary.User.rating += newRate.rate\r\n                commentary.rating += newRate.rate\r\n                await newRate.save()\r\n                await commentary.save()\r\n                await commentary.User.save()\r\n                ctx.body = {success: true, rating: commentary.rating}\r\n            }\r\n        })\r\n\r\n    .get('/comment/:id/delete',\r\n        authMiddleware(),\r\n        async(ctx) => {\r\n            let commentId = ctx.params.id\r\n            await Commentary.destroy({\r\n                where: {\r\n                    id: commentId\r\n                }\r\n            })\r\n            ctx.body = {success: true}\r\n        })\r\n\r\n\r\nexport default CommentController\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/CommentController.ts","import {Tag} from '../models/models';\r\nimport * as Router from 'koa-router';\r\n\r\nconst TagController = new Router()\r\n\r\nTagController\r\n    \r\n        .get('/tag/:id',\r\n            async (ctx) => {\r\n                let id = ctx.params.id\r\n                let tag = await Tag.findById(id)\r\n                ctx.body = {success: true, tagName: tag.name}\r\n            })\r\n  \r\n\r\n\r\nexport default TagController\r\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/TagController.ts","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"koa-convert\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-convert\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"koa-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-cors\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"koa-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-logger\"\n// module id = 36\n// module chunks = 0","const Pug = require('koa-pug')\r\n\r\nconst pug = new Pug({\r\n  viewPath: './views',\r\n  noCache: true\r\n})\r\n\r\nexport default pug\r\n\n\n\n// WEBPACK FOOTER //\n// ./config/pug.ts","module.exports = require(\"koa-pug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-pug\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"koa-json\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-json\"\n// module id = 39\n// module chunks = 0","import { MiddlewareGlobalBefore, MiddlewareInterface } from 'routing-controllers'\r\nimport { Context } from 'koa'\r\n\r\n\r\n\r\nconst cookieMiddleware = (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\r\n        const cookieHeader = context.headers.cookie\r\n        if (cookieHeader) {\r\n            const cookies = cookieHeader.split(';')\r\n            context.cookie = {}\r\n            cookies.forEach(function (item) {\r\n                const crumbs = item.split('=');\r\n                if (crumbs.length > 1) context.cookie[crumbs[0].trim()] = crumbs[1].trim()\r\n            })\r\n        }\r\n        return next()\r\n    }\r\n\r\nexport default cookieMiddleware\r\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/CookieMiddleware.ts"],"sourceRoot":""}