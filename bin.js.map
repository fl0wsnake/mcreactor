{"version":3,"sources":["webpack/bootstrap 2d6b338c75a6dbdfd8a3","D:\\1WebProjects\\mcreactor\\app.ts","external \"es6-shim\"","external \"reflect-metadata\"","external \"koa\"","external \"koa-router\"","D:\\1WebProjects\\mcreactor\\controllers\\AuthController.ts","D:\\1WebProjects\\mcreactor\\models\\models.ts","D:\\1WebProjects\\mcreactor\\models\\CommentaryRate.ts","D:\\1WebProjects\\mcreactor\\config\\db.ts","external \"sequelize\"","D:\\1WebProjects\\mcreactor\\models\\PostRate.ts","D:\\1WebProjects\\mcreactor\\models\\Post.ts","D:\\1WebProjects\\mcreactor\\models\\Commentary.ts","D:\\1WebProjects\\mcreactor\\models\\Tag.ts","D:\\1WebProjects\\mcreactor\\models\\User.ts","D:\\1WebProjects\\mcreactor\\models\\Subscription.ts","D:\\1WebProjects\\mcreactor\\models\\Ban.ts","D:\\1WebProjects\\mcreactor\\mocks\\users.ts","external \"fs\"","external \"sha256\"","D:\\1WebProjects\\mcreactor\\config\\jwt.ts","external \"jsonwebtoken\"","D:\\1WebProjects\\mcreactor\\controllers\\FeedController.ts","external \"koa-multer\"","D:\\1WebProjects\\mcreactor\\controllers\\UserController.ts","D:\\1WebProjects\\mcreactor\\middlewares\\AuthMiddleware.ts","D:\\1WebProjects\\mcreactor\\middlewares\\AdminMiddleware.ts","D:\\1WebProjects\\mcreactor\\controllers\\PostController.ts","D:\\1WebProjects\\mcreactor\\lib\\post.ts","D:\\1WebProjects\\mcreactor\\controllers\\CommentController.ts","D:\\1WebProjects\\mcreactor\\controllers\\TagController.ts","external \"path\"","external \"koa-convert\"","external \"koa-static\"","external \"koa-bodyparser\"","external \"koa-cors\"","external \"koa-logger\"","D:\\1WebProjects\\mcreactor\\config\\pug.ts","external \"koa-pug\"","external \"koa-json\"","D:\\1WebProjects\\mcreactor\\middlewares\\CookieMiddleware.ts"],"names":[],"mappings":"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","file":"bin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2d6b338c75a6dbdfd8a3","import 'es6-shim'\nimport \"reflect-metadata\";\nimport * as Koa from \"koa\"\nimport * as Router from 'koa-router'\nimport AuthController from './controllers/AuthController'\nimport FeedController from './controllers/FeedController'\nimport UserController from './controllers/UserController'\nimport PostController from './controllers/PostController'\nimport CommentController from './controllers/CommentController'\nimport TagController from './controllers/TagController'\nimport { Context } from 'koa';\n\nconst path = require('path')\n\nconst convert = require('koa-convert')\n\nconst serve = require('koa-static')\n\nconst app = new Koa()\n\napp.use(require('koa-bodyparser')())\n\napp.use(convert(serve('./public')))\n// app.use(convert(serve('./public/images')))\n\nlet cors = require('koa-cors')\nlet logger = require('koa-logger')\n\napp.use(convert(logger()))\n\napp.use(convert(cors()))\n\nimport pug from './config/pug'\n\npug.use(app)\n\napp.use(convert(require('koa-json')()))\n\nimport cookieMiddleware from './middlewares/CookieMiddleware';\n\napp.use(cookieMiddleware)\n\nconst router = new Router()\n\n\nrouter\n    .use('',UserController.routes())\n    .use('',AuthController.routes())\n    .use('',FeedController.routes())\n    .use('',PostController.routes())\n    .use('',CommentController.routes())\n    .use('',TagController.routes())\n\napp\n    .use(router.routes())\n    .use(router.allowedMethods())\n\napp.listen(3000)\n\n\n\n// WEBPACK FOOTER //\n// ./app.ts","module.exports = require(\"es6-shim\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"es6-shim\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"reflect-metadata\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"reflect-metadata\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 4\n// module chunks = 0","import { UserAttribute, UserModel } from '../models/User';\nimport { User, Subscription } from '../models/models';\nimport { generateToken } from '../config/jwt';\nimport { Request } from '~koa/lib/request';\nimport { Response } from '~koa/lib/response';\nimport * as Router from 'koa-router'\nimport { Context } from 'koa';\n\nconst hash = require('sha256')\n\nconst AuthController = new Router()\n\nAuthController\n\n    .get('/login',\n    (ctx: Context) => {\n        ctx.body = []\n    })\n\n    .post('/login',\n    async (ctx: Context): Promise<any> => {\n        const user = ctx.request.body\n        const found = await User.findOne({\n            where: {\n                email: user.email\n            },\n            include:[\n                Subscription\n            ]\n        })\n        if (found && found.password == hash(user.password))\n            ctx.body =  { success: true, token: generateToken(found.dataValues) }\n        else if (!found)\n            ctx.body =  { success: false, message: 'Wrong email' }\n        else\n            ctx.body = { success: false, message: 'Wrong password' }\n    })\n\n    .get('/register',\n    async (ctx: Context) => {\n        ctx.body = []\n    })\n    \n    .post('/register',\n    async (ctx: Context) => {\n        let user = ctx.request.body\n        if (user.password != user.confirmPassword)\n            ctx.body = { success: false, message: 'Passwords do not match' }\n        user.password = hash(user.password)\n        try {\n            let createdUser = await User.create(user)\n        }\n        catch (err) {\n            console.log(err)\n            if (err.name == \"SequelizeUniqueConstraintError\")\n                ctx.body =  { success: false, message: 'Email busy' }\n            ctx.body =  { success: false, message: 'Some error' }\n        }\n        ctx.body =  { success: true, message: '' }\n    })\n\nexport default AuthController\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/AuthController.ts","import CommentaryRate from './CommentaryRate';\nimport PostRate from './PostRate';\nimport Post from './Post';\nimport Commentary from './Commentary';\nimport Tag from './Tag';\nimport User from './User';\nimport * as Sequelize from 'sequelize';\nimport db from '../config/db';\nimport Subscription from \"./Subscription\";\nimport Ban from \"./Ban\";\nimport users from \"../mocks/users\";\nimport * as fs from 'fs';\n\nPost.belongsTo(User)\n\nUser.hasMany(Post)\n\nUser.hasMany(Commentary)\n\nCommentary.belongsTo(User)\n\nPost.hasMany(Commentary, {\n    onDelete: 'CASCADE'\n})\n\nCommentary.belongsTo(Post)\n\nconst PostTag = db.define('PostTag', {}, {tableName: 'PostTag'})\n\nTag.belongsToMany(Post, {through: 'PostTag'})\n\nPost.belongsToMany(Tag, {through: 'PostTag'})\n\nPostRate.belongsTo(Post)\n\nPostRate.belongsTo(User)\n\nPost.hasMany(PostRate, {\n    onDelete: 'CASCADE'\n})\n\nCommentaryRate.belongsTo(Commentary)\n\nCommentaryRate.belongsTo(User)\n\nCommentary.hasMany(CommentaryRate, {\n    onDelete: 'CASCADE'\n})\n\nSubscription.belongsTo(User)\n\nSubscription.belongsTo(Tag)\n\nUser.hasMany(Subscription, {\n    onDelete: 'CASCADE'\n})\n\nTag.hasMany(Subscription, {\n    onDelete: 'CASCADE'\n})\n\nBan.belongsTo(User)\n\nBan.belongsTo(Tag)\n\nUser.hasMany(Ban, {\n    onDelete: 'CASCADE'\n})\n\nTag.hasMany(Ban)\n\n;(async() => {\n    await User.sync({force: true})\n    await Post.sync({force: true})\n    await Tag.sync({force: true})\n    await PostTag.sync({force: true})\n    await Commentary.sync({force: true})\n    await PostRate.sync({force: true})\n    await CommentaryRate.sync({force: true})\n    await Ban.sync({force: true})\n    await Subscription.sync({force: true})\n\n    ;(async() => {\n        await User.bulkCreate(users.map(user => {\n            user.password = require('sha256')(user.password)\n            return user\n        }))\n        let query = fs.readFileSync('./mocks/posts.sql', 'utf-8')\n        await db.query(query)\n    })()\n})()\n\nexport {Tag, Commentary, Post, User, CommentaryRate, PostRate, Ban, Subscription}\n\n\n\n// WEBPACK FOOTER //\n// ./models/models.ts","import { CommentaryInstance } from './Commentary';\nimport { UserInstance } from './User';\n/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from 'sequelize';\n\nexport interface CommentaryRateAttribute {\n    id?: number\n    rate: number\n    User?: UserInstance\n    Commentary?: CommentaryInstance\n}\n\nexport interface CommentaryRateInstance extends Sequelize.Instance<CommentaryRateAttribute>, CommentaryRateAttribute\n{ }\n\nexport interface CommentaryRateModel extends Sequelize.Model<CommentaryRateInstance, CommentaryRateAttribute>\n{ }\n\nconst CommentaryRate: CommentaryRateModel = db.define<CommentaryRateInstance, CommentaryRateAttribute>(\"CommentaryRate\", {\n    rate: {\n        type: Sequelize.INTEGER(2),\n        allowNull: false,\n    }\n}, {\n        timestamps: true\n})\n\n\nexport default CommentaryRate\n\n\n\n// WEBPACK FOOTER //\n// ./models/CommentaryRate.ts","/**\n * Created by Monyk on 05.11.2016.\n */\nimport * as Sequelize from 'sequelize'\n\nconst db : Sequelize.Sequelize = new Sequelize('mysql://root:root@db/mcreactor', {\n    dialectOptions: {\n        multipleStatements: true\n    }\n})\n\nexport default db\n\n\n\n// WEBPACK FOOTER //\n// ./config/db.ts","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 9\n// module chunks = 0","import { PostInstance } from './Post';\nimport { UserInstance } from './User';\n/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\nexport interface PostRateAttribute {\n    id?: number\n    rate?: number\n    User?:UserInstance\n    Post?:PostInstance\n}\n\nexport interface PostRateInstance extends Sequelize.Instance<PostRateAttribute>, PostRateAttribute\n{ }\n\nexport interface PostRateModel extends Sequelize.Model<PostRateInstance, PostRateAttribute>\n{ }\n\nconst PostRate: PostRateModel = db.define<PostRateInstance, PostRateAttribute>(\"PostRate\", {\n    rate: {\n        type: Sequelize.INTEGER(2),\n        allowNull: false,\n    }\n}, {\n        timestamps: true\n})\n\n\nexport default PostRate\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/PostRate.ts","import { UserInstance } from './User';\n/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\nexport interface PostAttribute {\n    id?: number\n    content?: String\n    image?: String\n    createdAt?: number\n    updatedAt?: number\n    Tags?: Array<any>\n    UserId?: number\n    rating?: number\n    getTags?: any\n    User?: UserInstance\n}\n\nexport interface PostInstance extends Sequelize.Instance<PostAttribute>, PostAttribute\n{ }\n\nexport interface PostModel extends Sequelize.Model<PostInstance, PostAttribute>\n{ }\n\nconst Post: PostModel = db.define<PostInstance, PostAttribute>(\"Post\", {\n    content: {\n        type: Sequelize.TEXT,\n        allowNull: false,\n    },\n    image: {\n        type: Sequelize.STRING,\n        allowNull: true\n    },\n    rating: {\n        type: Sequelize.INTEGER,\n        defaultValue: 0\n    }\n}, {\n        timestamps: true\n    })\n\nexport default Post\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/Post.ts","import { UserInstance } from './User';\n/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\n\nexport interface CommentaryAttribute\n{\n    id?:number\n    content?:any\n    createdAt?:number\n    updatedAt?:number\n    rating?:number\n    User?:UserInstance\n}\n\nexport interface CommentaryInstance extends Sequelize.Instance<CommentaryAttribute>, CommentaryAttribute\n{}\n\nexport interface CommentaryModel extends Sequelize.Model<CommentaryInstance, CommentaryAttribute>\n{}\n\nconst Commentary : CommentaryModel = db.define<CommentaryInstance, CommentaryAttribute>(\"Commentary\", {\n    content: {\n        type: Sequelize.STRING,\n        allowNull: false,\n    },\n    rating: {\n        type: Sequelize.INTEGER,\n        allowNull: true,\n        defaultValue:0\n    }\n}, {\n    timestamps: true\n})\n\n\nexport default Commentary\n\n\n\n// WEBPACK FOOTER //\n// ./models/Commentary.ts","/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\nexport interface TagAttribute\n{\n    id?:number\n    name: string\n    createdAt?:number\n    updatedAt?:number\n}\n\nexport interface TagInstance extends Sequelize.Instance<TagAttribute>, TagAttribute\n{}\n\nexport interface TagModel extends Sequelize.Model<TagInstance, TagAttribute>\n{}\n\nconst Tag : TagModel = db.define<TagInstance, TagAttribute>(\"Tag\", {\n    name: {\n        type: Sequelize.STRING,\n        allowNull: false,\n        unique: true\n    }\n}, {\n    indexes:[\n        {\n            fields: ['name'],\n            unique: true\n        }\n    ],\n    timestamps: true,\n})\n\n\nexport default Tag\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./models/Tag.ts","/**\n * Created by Monyk on 06.11.2016.\n */\nimport db from '../config/db'\nimport * as Sequelize from \"sequelize\";\n\nexport interface UserAttribute\n{\n    id?:number\n    nickname?:string\n    email?:string\n    password?:string\n    rating?:number\n    isBanned?:boolean\n    isAdmin?:boolean\n    createdAt?:number\n    updatedAt?:number\n}\n\nexport interface UserInstance extends Sequelize.Instance<UserAttribute>, UserAttribute\n{}\n\nexport interface UserModel extends Sequelize.Model<UserInstance, UserAttribute>\n{}\n\nconst User : UserModel = db.define<UserInstance, UserAttribute>(\"User\", {\n    nickname: {\n        type: Sequelize.STRING(30),\n        allowNull: false,\n    },\n    email: {\n        type: Sequelize.STRING(50),\n        allowNull: false,\n        unique: true\n    },\n    password: {\n        type: Sequelize.STRING(100),\n        allowNull: false\n    },\n    rating: {\n        type: Sequelize.INTEGER\n    },\n    isBanned: {\n        type: Sequelize.BOOLEAN,\n        allowNull: true\n    },\n    isAdmin: {\n        type: Sequelize.BOOLEAN,\n        allowNull: true\n        \n    },\n}, {\n    timestamps: true\n})\n\n\n\nexport default User\n\n\n\n// WEBPACK FOOTER //\n// ./models/User.ts","import db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\nimport {TagInstance} from \"./Tag\";\r\nimport {UserInstance} from './User';\r\n\r\n\r\nexport interface SubscriptionAttribute\r\n{\r\n    id?: number\r\n    User?:UserInstance\r\n    Tag?:TagInstance\r\n    createdAt?:number\r\n    updatedAt?:number\r\n    UserId?:number\r\n    TagId?:number\r\n}\r\n\r\nexport interface SubscriptionInstance extends Sequelize.Instance<SubscriptionAttribute>, SubscriptionAttribute\r\n{}\r\n\r\nexport interface SubscriptionModel extends Sequelize.Model<SubscriptionInstance, SubscriptionAttribute>\r\n{}\r\n\r\nconst Subscription : SubscriptionModel = db.define<SubscriptionInstance, SubscriptionAttribute>(\"Subscription\", {\r\n    \r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\nexport default Subscription\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Subscription.ts","import db from '../config/db'\r\nimport * as Sequelize from \"sequelize\";\r\nimport {TagInstance} from \"./Tag\";\r\nimport {UserInstance} from './User';\r\n\r\n\r\nexport interface BanAttribute\r\n{\r\n    id?: number\r\n    User?:UserInstance\r\n    Tag?:TagInstance\r\n    createdAt?:number\r\n    updatedAt?:number\r\n    UserId?:number\r\n    TagId?:number\r\n}\r\n\r\nexport interface BanInstance extends Sequelize.Instance<BanAttribute>, BanAttribute\r\n{}\r\n\r\nexport interface BanModel extends Sequelize.Model<BanInstance, BanAttribute>\r\n{}\r\n\r\nconst Ban : BanModel = db.define<BanInstance, BanAttribute>(\"Ban\", {\r\n\r\n}, {\r\n    timestamps: true\r\n})\r\n\r\n\r\nexport default Ban\r\n\n\n\n// WEBPACK FOOTER //\n// ./models/Ban.ts","const users = [{\n    \"isAdmin\": true,\n    \"rating\": 21,\n    \"isBanned\": null,\n    \"email\": \"admin@gmail.com\",\n    \"nickname\": \"admin\",\n    \"password\": \"admin\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 87,\n    \"isBanned\": null,\n    \"email\": \"jburton1@smugmug.com\",\n    \"nickname\": \"cramos1\",\n    \"password\": \"aAJfgYUpMgs\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 42,\n    \"isBanned\": null,\n    \"email\": \"kday2@photobucket.com\",\n    \"nickname\": \"jprice2\",\n    \"password\": \"fQ7IZbm\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 12,\n    \"isBanned\": false,\n    \"email\": \"gyoung3@dyndns.org\",\n    \"nickname\": \"dpierce3\",\n    \"password\": \"za5DeM\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 96,\n    \"isBanned\": null,\n    \"email\": \"gburns4@smugmug.com\",\n    \"nickname\": \"jclark4\",\n    \"password\": \"SyAHlw8L69K2\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 67,\n    \"isBanned\": null,\n    \"email\": \"smorales5@godaddy.com\",\n    \"nickname\": \"ralvarez5\",\n    \"password\": \"54QgRT2OHLJC\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 41,\n    \"isBanned\": null,\n    \"email\": \"kmoreno6@seesaa.net\",\n    \"nickname\": \"lmurray6\",\n    \"password\": \"aS1ZtShNaph\"\n}, {\n    \n    \"isAdmin\": false,\n    \"rating\": 24,\n    \"isBanned\": null,\n    \"email\": \"aferguson7@google.com\",\n    \"nickname\": \"mnguyen7\",\n    \"password\": \"3DQeUgDK\"\n}]\n\nexport default users\n\n\n// WEBPACK FOOTER //\n// ./mocks/users.ts","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"sha256\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sha256\"\n// module id = 19\n// module chunks = 0","import { UserAttribute } from '../models/User';\nconst jwt = require('jsonwebtoken')\n\nconst secret = 'veryverysecret'\n\nexport function generateToken(user : UserAttribute) : string\n{\n    return jwt.sign(user, secret)\n}\n\nexport function verifyToken(token : string | undefined) : UserAttribute | false\n{\n    if(token)\n    {\n        let user\n        try {\n            user = jwt.verify(token, secret)\n        } catch(err)\n        {\n            return false\n        }\n        return user\n    }\n    return false\n}\n\n\n\n// WEBPACK FOOTER //\n// ./config/jwt.ts","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 21\n// module chunks = 0","import authMiddleware from '../middlewares/AuthMiddleware';\n\nimport { Response } from '~koa/lib/response';\nimport { User, Commentary, Tag, Post } from '../models/models';\nimport * as Router from 'koa-router';\nimport { Context } from 'koa';\nimport db from '../config/db';\n\n\nconst multer = require('koa-multer')\nconst upload = multer({ dest: './public/images' })\n\nconst FeedController = new Router()\n\nFeedController\n\n    .get('/',\n    (ctx: Context) => {\n        ctx.render('index')\n    })\n\n\n\nexport default FeedController\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/FeedController.ts","module.exports = require(\"koa-multer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-multer\"\n// module id = 23\n// module chunks = 0","/**\n * Created by Monyk on 05.11.2016.\n */\n\nimport * as Router from 'koa-router';\nimport {Context} from 'koa';\nimport {User, Subscription, Tag, Ban, Post} from '../models/models';\nimport authMiddleware from '../middlewares/AuthMiddleware';\nimport getPosts from \"../lib/post\";\nimport adminMiddleware from \"../middlewares/AdminMiddleware\";\n\nconst UserController = new Router()\n\n// UserController.use(authMiddleware)\n\nUserController\n    \n    .get('/user',\n        authMiddleware(),\n        async(ctx: Context) => {\n            ctx.body = await User.findAll({raw: true, order: 'id'})\n        })\n    \n    .get('/user/:id',\n        async(ctx) => {\n            let id = ctx.params.id\n            ctx.body = await User.findById(id)\n        })\n    \n    .put('/user/:id',\n        async(ctx: Context) => {\n            let id = ctx.params.id\n            let user = ctx.request.body\n            const foundUser = await User.findById(id)\n            if (foundUser)\n            {\n                ctx.body = (await foundUser.update(user)).get()\n            }\n            ctx.body = {success: false, message: 'User not found'}\n        })\n    \n    .get('/user/:id/subscriptions',\n        async(ctx) => {\n            let id = ctx.params.id\n            let subscriptions = await Subscription.findAll({\n                where: {\n                    UserId: id\n                },\n                include: [Tag]\n            })\n            let bans = await Ban.findAll({\n                where: {\n                    UserId: id\n                },\n                include: [Tag]\n            })\n            ctx.body = {success: true, subscriptions: subscriptions, bans: bans}\n        })\n    \n    .get('/user/:id/tag/:tagId/subscribe',\n        async(ctx) => {\n            try\n            {\n                let userId = ctx.params.id\n                let tagId = ctx.params.tagId\n                await Ban.destroy({\n                    where: {\n                        UserId: userId,\n                        TagId: tagId\n                    }\n                })\n                await Subscription.create({\n                    UserId: userId,\n                    TagId: tagId\n                })\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: 'Something went wrong'}\n                return\n            }\n            ctx.body = {success: true}\n        })\n    \n    .get('/user/:id/tag/:tagId/unsubscribe',\n        async(ctx) => {\n            try\n            {\n                let userId = ctx.params.id\n                let tagId = ctx.params.tagId\n                await Subscription.destroy({\n                    where: {\n                        UserId: userId,\n                        TagId: tagId\n                    }\n                })\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: 'Something went wrong'}\n                return\n            }\n            ctx.body = {success: true}\n        })\n    \n    .get('/user/:id/tag/:tagId/ban',\n        async(ctx) => {\n            try\n            {\n                let userId = ctx.params.id\n                let tagId = ctx.params.tagId\n                await Subscription.destroy({\n                    where: {\n                        UserId: userId,\n                        TagId: tagId\n                    }\n                })\n                await Ban.create({\n                    UserId: userId,\n                    TagId: tagId\n                })\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: 'Something went wrong'}\n                return\n            }\n            ctx.body = {success: true}\n        })\n    \n    .get('/user/:id/tag/:tagId/unban',\n        async(ctx) => {\n            try\n            {\n                let userId = ctx.params.id\n                let tagId = ctx.params.tagId\n                await Ban.destroy({\n                    where: {\n                        UserId: userId,\n                        TagId: tagId\n                    }\n                })\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: 'Something went wrong'}\n                return\n            }\n            ctx.body = {success: true}\n        })\n    \n    .get('/user/:id/ban',\n        authMiddleware(),\n        adminMiddleware,\n        async(ctx) => {\n            let id = ctx.params.id\n            await User.update({\n                isBanned: true\n            }, {\n                where: {\n                    id: id\n                }\n            })\n            await Post.destroy({\n                where: {\n                    UserId: id\n                }\n            })\n            ctx.body = {success: true}\n        })\n    \n    .get('/user/:id/unban',\n        authMiddleware(),\n        adminMiddleware,\n        async(ctx) => {\n            let id = ctx.params.id\n            await User.update({\n                isBanned: false\n            }, {\n                where: {\n                    id: id\n                }\n            })\n            ctx.body = {success: true}\n        })\n\nexport default UserController\n\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/UserController.ts","import {Context} from 'koa'\nimport {UserAttribute} from '../models/User';\nimport {verifyToken} from '../config/jwt';\n\n\nconst authMiddleware = (allowNotLoggedIn: boolean = false) => {\n    return (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\n        let token = false\n        if (context.cookie)\n            token = context.cookie.token\n        if (token)\n        {\n            const user: UserAttribute | boolean = verifyToken(token.toString())\n            if (user)\n            {\n                context.user = user\n                return next()\n            }\n        }\n        context.user = null\n        \n        if (!allowNotLoggedIn)\n        {\n            context.response.status = 403\n            context.response.body = '403 Forbidden'\n            return\n        }\n        else\n        {\n            return next()\n        }\n    }\n}\n\nexport default authMiddleware\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AuthMiddleware.ts","import { Context } from 'koa';\n\n const adminMiddleware = (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\n        if (context.user && context.user.isAdmin) \n        {\n            return next()\n        }\n        context.status = 403\n        context.body = '403 Forbidden'\n        return\n    }\n\nexport default adminMiddleware\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/AdminMiddleware.ts","import PostRate from '../models/PostRate';\nimport db from '../config/db';\nimport authMiddleware from '../middlewares/AuthMiddleware';\nimport {Commentary, Tag, User, Post} from '../models/models';\nimport {Context} from '~koa/lib/context';\nimport * as Router from 'koa-router';\nimport getPosts from \"../lib/post\";\nimport adminMiddleware from \"../middlewares/AdminMiddleware\";\n\nconst PostController = new Router()\n\nconst multer = require('koa-multer')\nconst upload = multer({dest: './public/images'})\n\nPostController\n    \n    .post('/post',\n        upload.single('image'),\n        authMiddleware(),\n        async(ctx: Context) => {\n            try\n            {\n                let userId = ctx.user.id\n                let tags = ctx.req.body.tags\n                              .split(',')\n                              .filter(tag => tag != '')\n                              .map(tag => {\n                                  return {'name': tag.trim()}\n                              })\n                \n                let image = ctx.req.file ? ctx.req.file.filename : null\n                \n                let post = await Post.create({\n                    content: ctx.req.body.content,\n                    image: image,\n                    UserId: userId\n                }) as any\n                \n                if (tags.length)\n                {\n                    await Tag.bulkCreate(tags, {\n                        updateOnDuplicate: ['name']\n                    })\n                    \n                    await post.setTags(await Tag.findAll({\n                        where: {\n                            name: {\n                                in: ctx.req.body.tags.split(',').map(tag => tag.trim())\n                            }\n                        }\n                    }))\n                }\n                ctx.body = {success: true, message: ''}\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: `Something went wrong: ${e}`}\n            }\n        })\n    \n    .get('/post/:id',\n        authMiddleware(true),\n        async(ctx) => {\n            const id = ctx.params.id\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, {\n                id: id\n            })\n        })\n    \n    .get('/post',\n        authMiddleware(true),\n        async(ctx) => {\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\n                    id: {\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\n                    }\n                } : null) //exclude banned posts when user is logged in\n        })\n    \n    .get('/best',\n        authMiddleware(true),\n        async(ctx) => {\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\n                    id: {\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\n                    },\n                    rating: {\n                        $gte: 50\n                    }\n                } : {\n                    rating: {\n                        $gte: 50\n                    }\n                }) //exclude banned posts when user is logged in\n        })\n    \n    .get('/good',\n        authMiddleware(true),\n        async(ctx) => {\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, ctx.user ? {\n                    id: {\n                        $notIn: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Bans` where `UserId` = \" + ctx.user.id + \"))\")\n                    },\n                    rating: {\n                        $gte: 20\n                    }\n                } : {\n                    rating: {\n                        $gte: 20\n                    }\n                }) //exclude banned posts when user is logged in\n        })\n    \n    .get('/post/tag/:id',\n        authMiddleware(true),\n        async(ctx) => {\n            let id = ctx.params.id\n            ctx.body = await getPosts(ctx.user.id, {\n                id: {\n                    $in: db.literal(\"(select `PostId` from `PostTag` where `TagId` = \" + id + \")\")\n                }\n            })\n        })\n    \n    .get('/post/user/subscribed',\n        authMiddleware(),\n        async(ctx) => {\n            let id = ctx.user.id\n            ctx.body = await getPosts(ctx.user.id, {\n                id: {\n                    $in: db.literal(\"(select `PostId` from `PostTag` where `TagId` in (select `TagId` from `Subscriptions` where `UserId` = \" + id + \"))\")\n                }\n            })\n        })\n    \n    //ajax rate route\n    .get('/post/:id/rate/:rate',\n        authMiddleware(),\n        async(ctx) => {\n            let id = ctx.params.id\n            let rate = ctx.params.rate\n            let previousRate = await PostRate.findOne({\n                where: {\n                    PostId: id,\n                    UserId: ctx.user.id\n                },\n                include: [Post, User]\n            })\n            if (previousRate)\n            {\n                previousRate.User.rating -= previousRate.rate\n                previousRate.Post.rating -= previousRate.rate\n                if (rate == 'neutral')\n                {\n                    await previousRate.destroy()\n                }\n                else\n                {\n                    previousRate.rate = (rate == 'like' ? 1 : -1)\n                    previousRate.User.rating += previousRate.rate\n                    previousRate.Post.rating += previousRate.rate\n                    await previousRate.save()\n                }\n                await previousRate.User.save()\n                await previousRate.Post.save()\n                ctx.body = {success: true, rating: previousRate.Post.rating}\n            }\n            else if (rate != 'neutral')\n            {\n                let newRate = await PostRate.create(<any>{\n                    rate: (rate == 'like' ? 1 : -1),\n                    UserId: ctx.user.id,\n                    PostId: id\n                })\n                let post = await Post.findById(id, {\n                    include: [User]\n                })\n                post.User.rating += newRate.rate\n                post.rating += newRate.rate\n                await newRate.save()\n                await post.save()\n                await post.User.save()\n                ctx.body = {success: true, rating: post.rating}\n            }\n            else\n            {\n                ctx.body = {success: true}\n            }\n        })\n    \n    \n    .get('/user/:id/profile',\n        authMiddleware(true),\n        async(ctx) => {\n            let userId = ctx.params.id\n            ctx.body = await getPosts(ctx.user ? ctx.user.id : null, {\n                UserId: userId\n            })\n        })\n    \n    .get('/post/:id/delete',\n        authMiddleware(),\n        async(ctx) => {\n            let postId = ctx.params.id\n            await Post.destroy({\n                where: {\n                    id: postId\n                }\n            })\n            ctx.body = {success: true}\n        })\n    \n    .post('/post/filter',\n        authMiddleware(true),\n        async(ctx) => {\n            let filter = ctx.request.body\n            let whereClause: any = {}\n            if (filter.tagsArray && filter.tagsArray.length)\n            {\n                filter.tags = filter.tagsArray\n                                    .filter(tag => tag != '')\n                                    .map(tag => \"'\" + tag.trim() + \"'\")\n                whereClause.id = {\n                    $in: db.literal(\" (select `Posts`.`id` from `Posts` \" +\n                        \"where (select count(`TagId`) from `PostTag` inner join `Tags` on `Tags`.`id` = `PostTag`.`TagId` \" +\n                        \"where `PostTag`.`PostId` = `Posts`.`id` and `Tags`.`name` in (\" + filter.tags.join(',') + \") ) = \" + filter.tags.length + \" ) \")\n                }\n            }\n            if (filter.content)\n                whereClause.content = {\n                    $like: `%${filter.content}%`\n                }\n            if (filter.dateFrom || filter.dateTo)\n            {\n                whereClause.createdAt = {}\n                if (filter.dateFrom)\n                    whereClause.createdAt.$gte = new Date(filter.dateFrom)\n                if (filter.dateTo)\n                {\n                    let date = new Date(filter.dateTo)\n                    date.setHours(23, 59, 59, 0)\n                    whereClause.createdAt.$lte = date\n                }\n            }\n            if (filter.ratingTo || filter.ratingFrom)\n            {\n                whereClause.rating = {}\n                if (filter.ratingTo)\n                    whereClause.rating.$lte = filter.ratingTo\n                if (filter.ratingFrom)\n                    whereClause.rating.$gte = filter.ratingFrom\n            }\n            console.log(whereClause)\n            let posts = await getPosts(ctx.user ? ctx.user.id : null, whereClause)\n            ctx.body = {success: true, posts}\n        })\n    \n    .get('/stats',\n        authMiddleware(),\n        adminMiddleware,\n        async(ctx) => {\n            let postCountByDay = await Post.findAll({\n                attributes: [db.fn('date', db.col('createdAt')), db.fn('count', 'id')],\n                group: [db.fn('date', db.col('createdAt'))],\n                raw: true\n            })\n            let commentCountByDay = await Commentary.findAll({\n                attributes: [db.fn('date', db.col('createdAt')), db.fn('count', 'id')],\n                group: [db.fn('date', db.col('createdAt'))],\n                raw: true\n            })\n            \n            ctx.body = {postCountByDay, commentCountByDay}\n        })\n\nexport default PostController\n\n\n// WEBPACK FOOTER //\n// ./controllers/PostController.ts","import {Commentary, Post, PostRate, Tag, User,CommentaryRate} from \"../models/models\";\r\n\r\nasync function getPosts(userId = null, where = null) {\r\n    return await Post.findAll({\r\n        where,\r\n        include: [\r\n            {\r\n                model: PostRate,\r\n                where: userId ? {\r\n                        UserId: userId\r\n                    } : null,\r\n                required: false\r\n            },\r\n            Tag,\r\n            User,\r\n            {\r\n                model: Commentary,\r\n                include: [User, {\r\n                    model: CommentaryRate,\r\n                    where: userId ? {\r\n                            UserId: userId\r\n                        } : null,\r\n                    required: false\r\n                }]\r\n            }\r\n        ],\r\n        order: [\r\n            ['createdAt', 'DESC'],\r\n            [Tag, 'name'],\r\n            [Commentary, 'createdAt']\r\n        ]\r\n    })\r\n}\r\n\r\nexport default getPosts\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./lib/post.ts","import authMiddleware from '../middlewares/AuthMiddleware';\nimport {Commentary, CommentaryRate, Tag, User, Post} from '../models/models';\nimport {Context} from '~koa/lib/context';\nimport * as Router from 'koa-router';\n\nconst CommentController = new Router()\n\nCommentController\n    \n    .post('/post/:id/comment',\n        authMiddleware(),\n        async(ctx) =>\n        {\n            try\n            {\n                let commentary = ctx.request.body\n                commentary.PostId = ctx.params.id\n                commentary.UserId = ctx.user.id\n                await Commentary.create(commentary)\n                let comments = await Commentary.findAll({\n                    where: {\n                        PostId: commentary.PostId\n                    },\n                    include: [User]\n                })\n                ctx.body = {success: true, message: 'comment created', comments: comments}\n            }\n            catch (e)\n            {\n                ctx.body = {success: false, message: `something went wrong: ${e}`}\n            }\n        })\n    \n    .get('/comment/:id/rate/:rate',\n        authMiddleware(),\n        async(ctx) =>\n        {\n            let id = ctx.params.id\n            let rate = ctx.params.rate\n            let previousRate = await CommentaryRate.findOne({\n                where: {\n                    CommentaryId: id,\n                    UserId: ctx.user.id\n                },\n                include: [Commentary, User]\n            })\n            if (previousRate)\n            {\n                previousRate.User.rating -= previousRate.rate\n                previousRate.Commentary.rating -= previousRate.rate\n                if (rate == 'neutral')\n                {\n                    await previousRate.destroy()\n                }\n                else\n                {\n                    previousRate.rate = (rate == 'like' ? 1 : -1)\n                    previousRate.User.rating += previousRate.rate\n                    previousRate.Commentary.rating += previousRate.rate\n                    await previousRate.save()\n                }\n                await previousRate.User.save()\n                await previousRate.Commentary.save()\n                ctx.body = {success: true, rating: previousRate.Commentary.rating}\n            }\n            else if (rate != 'neutral')\n            {\n                let newRate = await CommentaryRate.create(<any>{\n                    rate: (rate == 'like' ? 1 : -1),\n                    UserId: ctx.user.id,\n                    CommentaryId: id\n                })\n                let commentary = await Commentary.findById(id, {\n                    include: [User]\n                })\n                commentary.User.rating += newRate.rate\n                commentary.rating += newRate.rate\n                await newRate.save()\n                await commentary.save()\n                await commentary.User.save()\n                ctx.body = {success: true, rating: commentary.rating}\n            }\n        })\n\n    .get('/comment/:id/delete',\n        authMiddleware(),\n        async(ctx) => {\n            let commentId = ctx.params.id\n            await Commentary.destroy({\n                where: {\n                    id: commentId\n                }\n            })\n            ctx.body = {success: true}\n        })\n\n\nexport default CommentController\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/CommentController.ts","import {Tag} from '../models/models';\nimport * as Router from 'koa-router';\n\nconst TagController = new Router()\n\nTagController\n    \n        .get('/tag/:id',\n            async (ctx) => {\n                let id = ctx.params.id\n                let tag = await Tag.findById(id)\n                ctx.body = {success: true, tagName: tag.name}\n            })\n  \n\n\nexport default TagController\n\n\n\n// WEBPACK FOOTER //\n// ./controllers/TagController.ts","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 31\n// module chunks = 0","module.exports = require(\"koa-convert\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-convert\"\n// module id = 32\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"koa-cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-cors\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"koa-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-logger\"\n// module id = 36\n// module chunks = 0","const Pug = require('koa-pug')\n\nconst pug = new Pug({\n  viewPath: './views',\n  noCache: true\n})\n\nexport default pug\n\n\n\n// WEBPACK FOOTER //\n// ./config/pug.ts","module.exports = require(\"koa-pug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-pug\"\n// module id = 38\n// module chunks = 0","module.exports = require(\"koa-json\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-json\"\n// module id = 39\n// module chunks = 0","import { MiddlewareGlobalBefore, MiddlewareInterface } from 'routing-controllers'\nimport { Context } from 'koa'\n\n\n\nconst cookieMiddleware = (context: Context, next: (err?: any) => Promise<any>): Promise<any> | null => {\n        const cookieHeader = context.headers.cookie\n        if (cookieHeader) {\n            const cookies = cookieHeader.split(';')\n            context.cookie = {}\n            cookies.forEach(function (item) {\n                const crumbs = item.split('=');\n                if (crumbs.length > 1) context.cookie[crumbs[0].trim()] = crumbs[1].trim()\n            })\n        }\n        return next()\n    }\n\nexport default cookieMiddleware\n\n\n\n// WEBPACK FOOTER //\n// ./middlewares/CookieMiddleware.ts"],"sourceRoot":""}